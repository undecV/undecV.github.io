
<!DOCTYPE html>
<html lang="zh_tw">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://undecv.github.io/theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
    href="https://undecv.github.io/theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
          href="https://undecv.github.io/theme/pygments/monokai.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light)"
          href="https://undecv.github.io/theme/pygments/emacs.min.css">


  <link rel="stylesheet" type="text/css" href="https://undecv.github.io/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://undecv.github.io/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://undecv.github.io/theme/font-awesome/css/solid.css">

    <link href="https://undecv.github.io/theme/custom.css" rel="stylesheet">

    <link href="https://undecv.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="キャンディージャー Atom">


    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">


    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333">

<meta name="author" content="undecV" />
<meta name="description" content="Raspberry Pi 4B NAS Episode 1 (HDD &amp; USB)爬文是不可能爬文的，这辈子不可能爬文的。Spec 又不會查，Run 不起來纔是正常的樣子。" />
<meta name="keywords" content="zh_TW, Raspberry Pi, NAS, HDD, USB, USB HUB">


<meta property="og:site_name" content="キャンディージャー"/>
<meta property="og:title" content="Raspberry Pi 4B 搭建 NAS 第一話：外接式機械行動硬碟和 USB 篇"/>
<meta property="og:description" content="Raspberry Pi 4B NAS Episode 1 (HDD &amp; USB)爬文是不可能爬文的，这辈子不可能爬文的。Spec 又不會查，Run 不起來纔是正常的樣子。"/>
<meta property="og:locale" content="zh_TW"/>
<meta property="og:url" content="https://undecv.github.io/rPi4BNASEp1-cht.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2020-04-03 00:00:00+08:00"/>
<meta property="article:modified_time" content="2020-04-03 00:00:00+08:00"/>
<meta property="article:author" content="https://undecv.github.io/author/undecv.html">
<meta property="article:section" content="Category"/>
<meta property="article:tag" content="zh_TW"/>
<meta property="article:tag" content="Raspberry Pi"/>
<meta property="article:tag" content="NAS"/>
<meta property="article:tag" content="HDD"/>
<meta property="article:tag" content="USB"/>
<meta property="article:tag" content="USB HUB"/>
<meta property="og:image" content="/images/128.png">

  <title>キャンディージャー &ndash; Raspberry Pi 4B 搭建 NAS 第一話：外接式機械行動硬碟和 USB 篇</title>

</head>
<body >
  <aside>
    <div>
      <a href="https://undecv.github.io">
        <img src="/images/128.png" alt="キャンディージャー" title="キャンディージャー">
      </a>

      <h1>
        <a href="https://undecv.github.io">キャンディージャー</a>
      </h1>

<p>Candy jar</p>


      <ul class="social">
          <li>
            <a  class="sc-github" href="https://github.com/undecv" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-twitter" href="https://twitter.com/phinhdgxiaohai" target="_blank">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
          <li>
            <a  class="sc-telegram" href="https://t.me/s/poi0048" target="_blank">
              <i class="fab fa-telegram"></i>
            </a>
          </li>
          <li>
            <a  class="sc-rss" href="feeds/all.atom.xml" target="_blank">
              <i class="fas fa-rss"></i>
            </a>
          </li>
      </ul>
    </div>

  </aside>
  <main>

    <nav>
      <a href="https://undecv.github.io">Home</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="https://undecv.github.io/feeds/all.atom.xml">Atom</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="rPi4BNASEp1">Raspberry Pi 4B 搭建 NAS 第一話：外接式機械行動硬碟和 USB 篇</h1>
    <p>
      Posted on Fri 03 April 2020 in <a href="https://undecv.github.io/category/category.html">Category</a>

    </p>
  </header>


  <div>
    <p><del>爬文是不可能爬文的，这辈子不可能爬文的。Spec 又不會查，Run 不起來纔是正常的樣子。</del></p>
<blockquote>
<p>Copyright © 2020 undecV.</p>
</blockquote>
<p>原本想拿 <abbr title="Raspberry Pi 4B">rPi4B</abbr> 做 NAS 的，想當然耳，結果翻車了。</p>
<p>通常使用 USB 的設備吃電都是不多的，例如滑鼠、鍵盤、隨身碟等，但是使用機械行動硬碟的時候可能就需要考慮輸出功率的因素了。
機械硬碟吃功率主要看：</p>
<ul>
<li>冷啓動時的峯值功率 (Peak)</li>
<li>讀寫運作中的功率（r/w）</li>
<li>沒有讀寫的閒置功率（Idle）</li>
<li>待機功率（Standby and Sleep）</li>
</ul>
<p>現代的機械硬碟長時間沒有讀寫時會（停轉磁碟）待機以節省功率，這時候讀資料需要把磁碟重新轉起來，這也是爲什麼有時候從抓資料的時候硬碟會「當掉幾秒」的原因。</p>
<p>根據<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>（WD 紅碟的 Spec）<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup>（Toshiba 行動硬碟的 Spec）<sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup>：</p>
<ul>
<li>壹個典型的 3.5吋 內接式硬碟吃的是 12V 供電，峯值在 1.75A (21W)、讀寫大約 4.8W、閒置 3.1W，待機 0.6W；</li>
<li>壹個典型的 2.5吋 內接式硬碟吃的是 5V 供電，峯值在 1A (5W)、讀寫大約 1.4W、閒置 0.6W，待機 0.2W；</li>
<li>壹個典型的 2.5吋 行動硬碟，吃的是 USB 供電，最多 0.9A。</li>
</ul>
<p>具體請查 Spec，可以看出機械硬碟並不是省電的碟。
不是給手機充電（使用充電協定）的情況下，通常 USB 標準給外接裝置供電都是 5V，USB 2.0 最大 0.5A、USB 3.0 最大 0.9A <sup id="fnref:4"><a class="footnote-ref" href="#fn:4">4</a></sup>，而 USB3.1 的 Type-C 有支援最大 3A。</p>
<p>對於真正的 NAS，功率必然是需要考慮的問題，在硬碟、BIOS 和 驅動程式支援的情況下，Staggered Spin-up (SSU) 可以讓硬碟陣列輪流轉以控制使用中的功率 <sup id="fnref:7"><a class="footnote-ref" href="#fn:7">7</a></sup>；Power-Up In Standby (PUIS) 讓硬碟冷啟動時直接進入待機狀態而避免過大的峰值功率 <sup id="fnref:8"><a class="footnote-ref" href="#fn:8">8</a></sup>。</p>
<p>而像 <abbr title="Raspberry Pi 4B">rPi4B</abbr> 這種本身功率就不高，只有 USB-C 3A@5V 輸入，但卻有 2x2.0 2x3.0，若按照標準算全滿則是 2.8A，那板板本身就只能用愛發電了。所以就有了最大輸出的概念，<del>就像跟玩文字遊戲的手機充電器一樣，~</del><abbr title="Raspberry Pi 4B">rPi4B</abbr> 的 USB 電流最大總和只有 1.2A <sup id="fnref:5"><a class="footnote-ref" href="#fn:5">5</a></sup>。也就是說，插好插滿最多只能輸出 6W，超出限制的時候 <abbr title="Raspberry Pi 4B">rPi4B</abbr> 會保護性關機。</p>
<p>所以 <abbr title="Raspberry Pi 4B">rPi4B</abbr> 本身是只能插一個行動硬碟的。我直接插上了兩個硬碟之後 <abbr title="Raspberry Pi 4B">rPi4B</abbr> 自動重開了，然後聽到硬碟在唱跳 Rap，思考了一下人生之後趕緊給關了機。</p>
<p>那麼怎麼實現 <abbr title="Raspberry Pi 4B">rPi4B</abbr> 做 NAS 呢，可以使用帶外接電源的 USB HUB <sup id="fnref:6"><a class="footnote-ref" href="#fn:6">6</a></sup>。不帶電源的 HUB 當然用電都是從那唯一壹個 USB 接頭輸出，大約在 0.5A 甚至 0.1A，可以帶的裝置也就有限。<sup id="fnref2:4"><a class="footnote-ref" href="#fn:4">4</a></sup> 而帶電源的也需要看電源的功率，現在常見一種多一個 USB Micro-B 供電介面的小型 HUB，通常也只能從手機充電器供給 2A@5V (10W) 的功率（請查 Spec），仍然不足每個介面都插上行動硬碟。而一些附電源的 HUB 則需要根據提供的電源功率來試算。</p>
<div class="footnote">
<hr>
<ol>
<li id="fn:1">
<p><a href="http://products.wdc.com/library/SpecSheet/ENG/2879-800002.pdf">WD Red NAS Hard Drives (PDF)</a>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p><a href="https://www.toshiba-storage.com/products/toshiba-portable-hard-drives-canvio-basics-2/">Toshiba Canvio Basics</a>&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p>Super User: <a href="https://superuser.com/questions/565653/how-much-power-does-a-hard-drive-use">How much power does a hard drive use?</a>&#160;<a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:4">
<p>Wikipedia: <a href="https://en.wikipedia.org/wiki/USB">USB</a>&#160;<a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 4 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:4" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:5">
<p>Raspberry Pi Documentation: <a href="https://www.raspberrypi.org/documentation/faqs/#pi-power">FAQs</a>&#160;<a class="footnote-backref" href="#fnref:5" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn:6">
<p>Gary Explains @ YouTube: <a href="https://youtu.be/O-FfOWdZAQ4">Build a Raspberry Pi NAS with 4 Hard Drives and RAID</a>&#160;<a class="footnote-backref" href="#fnref:6" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
<li id="fn:7">
<p>Wikipedia: <a href="https://en.wikipedia.org/wiki/Spin-up">Spin-up</a>&#160;<a class="footnote-backref" href="#fnref:7" title="Jump back to footnote 7 in the text">&#8617;</a></p>
</li>
<li id="fn:8">
<p>Wikipedia: <a href="https://en.wikipedia.org/wiki/Power-up_in_standby">Power-up in standby</a>&#160;<a class="footnote-backref" href="#fnref:8" title="Jump back to footnote 8 in the text">&#8617;</a></p>
</li>
</ol>
</div>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://undecv.github.io/tag/zh_tw.html">zh_TW</a>
      <a href="https://undecv.github.io/tag/raspberry-pi.html">Raspberry Pi</a>
      <a href="https://undecv.github.io/tag/nas.html">NAS</a>
      <a href="https://undecv.github.io/tag/hdd.html">HDD</a>
      <a href="https://undecv.github.io/tag/usb.html">USB</a>
      <a href="https://undecv.github.io/tag/usb-hub.html">USB HUB</a>
    </p>
  </div>





</article>

    <footer>
<p>&copy; 2021 キャンディージャー</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="https://undecv.github.io/theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="dark"
          type="text/javascript">
  </script>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " キャンディージャー ",
  "url" : "https://undecv.github.io",
  "image": "/images/128.png",
  "description": "undecV's Blog"
}
</script>


</body>
</html>