
<!DOCTYPE html>
<html lang="zh_tw">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://undecv.github.io/theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
    href="https://undecv.github.io/theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
          href="https://undecv.github.io/theme/pygments/monokai.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light)"
          href="https://undecv.github.io/theme/pygments/emacs.min.css">


  <link rel="stylesheet" type="text/css" href="https://undecv.github.io/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://undecv.github.io/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://undecv.github.io/theme/font-awesome/css/solid.css">

    <link href="https://undecv.github.io/theme/custom.css" rel="stylesheet">

    <link href="https://undecv.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="キャンディージャー Atom">


    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">


    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333">

<meta name="author" content="undecV" />
<meta name="description" content="Raspberry Pi 4B NAS Episode 2 (Network)究竟讀寫速度會卡在 USB 還是 SMB 呢？rPi4B NAS 翻車最終話！\滑稽。" />
<meta name="keywords" content="zh_TW, Raspberry Pi, NAS, HDD, Ethernet, Wi-Fi">


<meta property="og:site_name" content="キャンディージャー"/>
<meta property="og:title" content="Raspberry Pi 4B 搭建 NAS 第二話：網路篇"/>
<meta property="og:description" content="Raspberry Pi 4B NAS Episode 2 (Network)究竟讀寫速度會卡在 USB 還是 SMB 呢？rPi4B NAS 翻車最終話！\滑稽。"/>
<meta property="og:locale" content="zh_TW"/>
<meta property="og:url" content="https://undecv.github.io/rPi4BNASEp2-cht.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2020-04-03 01:00:00+08:00"/>
<meta property="article:modified_time" content="2020-04-03 01:00:00+08:00"/>
<meta property="article:author" content="https://undecv.github.io/author/undecv.html">
<meta property="article:section" content="Category"/>
<meta property="article:tag" content="zh_TW"/>
<meta property="article:tag" content="Raspberry Pi"/>
<meta property="article:tag" content="NAS"/>
<meta property="article:tag" content="HDD"/>
<meta property="article:tag" content="Ethernet"/>
<meta property="article:tag" content="Wi-Fi"/>
<meta property="og:image" content="/images/128.png">

  <title>キャンディージャー &ndash; Raspberry Pi 4B 搭建 NAS 第二話：網路篇</title>

</head>
<body >
  <aside>
    <div>
      <a href="https://undecv.github.io">
        <img src="/images/128.png" alt="キャンディージャー" title="キャンディージャー">
      </a>

      <h1>
        <a href="https://undecv.github.io">キャンディージャー</a>
      </h1>

<p>Candy jar</p>


      <ul class="social">
          <li>
            <a  class="sc-github" href="https://github.com/undecv" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-twitter" href="https://twitter.com/phinhdgxiaohai" target="_blank">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
          <li>
            <a  class="sc-telegram" href="https://t.me/s/poi0048" target="_blank">
              <i class="fab fa-telegram"></i>
            </a>
          </li>
          <li>
            <a  class="sc-rss" href="feeds/all.atom.xml" target="_blank">
              <i class="fas fa-rss"></i>
            </a>
          </li>
      </ul>
    </div>

  </aside>
  <main>

    <nav>
      <a href="https://undecv.github.io">Home</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="https://undecv.github.io/feeds/all.atom.xml">Atom</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="rPi4BNASEp2">Raspberry Pi 4B 搭建 NAS 第二話：網路篇</h1>
    <p>
      Posted on Fri 03 April 2020 in <a href="https://undecv.github.io/category/category.html">Category</a>

    </p>
  </header>


  <div>
    <p><del>究竟讀寫速度會卡在 USB 還是 SMB 呢？<abbr title="Raspberry Pi 4B">rPi4B</abbr> NAS 翻車最終話！\滑稽。</del></p>
<blockquote>
<p>Copyright © 2020 undecV.</p>
</blockquote>
<p>供電的問題解決了，SMB 網路芳鄰也成功搭建了起來，那接下來就是喜聞樂見的測速時間了。</p>
<p>注意，以下使用的單位，小寫 <code>b</code> 是 <code>bits</code>，大寫 <code>B</code> 是 <code>Bytes</code>，<code>8 bit = 1 Byte</code>，全部使用十進位的 <code>1 MB = 1,000,000 Bytes</code>。</p>
<p>依據 <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>（WD 紅碟的 Spec），壹個典型的 2.5吋、5400RPM 的硬碟，144MB/s，根據可愛的 Shizuku <sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup> 測試我的行動硬碟，結果差不多。</p>
<p>USB 3.0 的理論速度是 5Gb/s，大約是 625MB/s <sup id="fnref:4"><a class="footnote-ref" href="#fn:4">4</a></sup>；根據 <abbr title="Raspberry Pi">rPi</abbr> 官方的說法 <sup id="fnref:5"><a class="footnote-ref" href="#fn:5">5</a></sup> 和基準測試 <sup id="fnref:6"><a class="footnote-ref" href="#fn:6">6</a></sup> 有約 343MB/s，所以 USB 在機械硬碟的速度下不會成為瓶頸。</p>
<p>同樣的，根據 Spec 和官方的測速 <sup id="fnref2:6"><a class="footnote-ref" href="#fn:6">6</a></sup>，Ethernet 可以有幾乎真正的 <abbr title="Gigabit Ethernet">GbE</abbr> 的 1Gb/s 的速度，當然要達到真正的 <abbr title="Gigabit Ethernet">GbE</abbr> 需要交換機、路由器、網路線、以及其他終端裝置支援。指令 ethtool eth0 可以檢視當前的連線頻寬（理想速度），然而，即使是按照理想的 1Gb/s 的速度計算，<abbr title="Gigabit Ethernet">GbE</abbr> 也僅有 125Mb/s。
在全程使用 <abbr title="Gigabit Ethernet">GbE</abbr> 的情景下，這速度會是瓶頸。</p>
<p>而 Wi-Fi 就更慘了，還是根據官方測速 <sup id="fnref3:6"><a class="footnote-ref" href="#fn:6">6</a></sup>，在 5GHz 之下僅有 114Mb/s（約 14MB/s）的實際速度。指令 iwconfig 可以檢視當前的連線頻寬（理想速度）。沒錯，明明是 Wi-Fi 5 卻連 4 都不如\滑稽。
在 <abbr title="Raspberry Pi 4B">rPi4B</abbr> 使用 Wi-Fi 的情況下，這速度會是瓶頸。</p>
<p>但是吼，話雖這麼說，不要忘記了，<abbr title="Raspberry Pi 4B">rPi4B</abbr> 再怎麼說也只要一兩張小學生的 Low Cost 裝置，你還想怎樣（錘。</p>
<p>可以使用 iperf3 <sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup> 進行網路的實際速度的測試。
可以使用可愛的 Shizuku <sup id="fnref2:2"><a class="footnote-ref" href="#fn:2">2</a></sup> 對本地和遠端的硬碟做讀寫速度測試。</p>
<p>而，一般家用無線路由器，甚至終端裝置（電腦、手機）的 Wi-Fi 速度亦有可能成為瓶頸，例如一個標稱 AC1200 的家用無線路由器 <sup id="fnref:7"><a class="footnote-ref" href="#fn:7">7</a></sup>，在 Wi-Fi 5（即 802.11ac）的 5GHz 之下的理論速度是 867Mb/s（約 108MB/s），而 Wi-Fi 的實際速度是非常看臉的，會收到距離、角度、障礙物、雜訊、姿勢、走位等諸多因素的影響。
在 <abbr title="Raspberry Pi 4B">rPi4B</abbr> 使用 <abbr title="Gigabit Ethernet">GbE</abbr>，而終端裝置使用 Wi-Fi 卻吃不到 <abbr title="Gigabit Ethernet">GbE</abbr> 以上速度的時候，這速度會是瓶頸。</p>
<p>而官方討論區中所述的問題，很幸運的我沒有遇到。大概是說，NTFS 在 Linux 上效能不佳，可以使用原生的 ext4 檔案系統 <sup id="fnref:8"><a class="footnote-ref" href="#fn:8">8</a></sup>，以及行動硬碟的相容問題 <sup id="fnref:9"><a class="footnote-ref" href="#fn:9">9</a></sup>。</p>
<p>總結，在假設路由器、網路線等其他裝置都支援 <abbr title="Gigabit Ethernet">GbE</abbr>，無線網路 AC1200 的情況下：</p>
<ul>
<li>直接的硬碟讀寫速度：144MB/s；</li>
<li><abbr title="Raspberry Pi 4B">rPi4B</abbr>、電腦都使用有線網路：瓶頸會是有線網路 <abbr title="Gigabit Ethernet">GbE</abbr>，125MB/s；</li>
<li><abbr title="Raspberry Pi 4B">rPi4B</abbr> 使用有線網路，電腦使用無線網路：瓶頸會是無線網路，108MB/s；</li>
<li><abbr title="Raspberry Pi 4B">rPi4B</abbr> 使用無線網路：瓶頸會是 <abbr title="Raspberry Pi 4B">rPi4B</abbr> 的無線網路，14MB/s；</li>
</ul>
<p>在家拉光纖指日可待。</p>
<div class="footnote">
<hr>
<ol>
<li id="fn:1">
<p><a href="http://products.wdc.com/library/SpecSheet/ENG/2879-800002.pdf">WD Red NAS Hard Drives (PDF)</a>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>Crystal Dew World： <a href="https://crystalmark.info/en/software/crystaldiskmark/">CrystalDiskMark</a>&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p>Wikipedia: <a href="https://en.wikipedia.org/wiki/Iperf">Iperf</a>&#160;<a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:4">
<p>Wikipedia: <a href="https://en.wikipedia.org/wiki/USB">USB</a>&#160;<a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:5">
<p>Raspberry Pi Documentation: <a href="https://www.raspberrypi.org/documentation/hardware/raspberrypi/usb/README.md">USB</a>&#160;<a class="footnote-backref" href="#fnref:5" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn:6">
<p>The MagPi magazine: <a href="https://magpi.raspberrypi.org/articles/raspberry-pi-4-specs-benchmarks">Raspberry Pi 4 specs and benchmarks</a>&#160;<a class="footnote-backref" href="#fnref:6" title="Jump back to footnote 6 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:6" title="Jump back to footnote 6 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:6" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
<li id="fn:7">
<p>MikroTik Routers and Wireless: <a href="https://mikrotik.com/product/hap_ac2">hAP ac²</a>&#160;<a class="footnote-backref" href="#fnref:7" title="Jump back to footnote 7 in the text">&#8617;</a></p>
</li>
<li id="fn:8">
<p>Raspberry Pi Forums: <a href="https://www.raspberrypi.org/forums/viewtopic.php?f=91&amp;t=243962">Slow samba transfer speed on RPi4 to a usb 3.0 drive (10,4mb/s)</a>&#160;<a class="footnote-backref" href="#fnref:8" title="Jump back to footnote 8 in the text">&#8617;</a></p>
</li>
<li id="fn:9">
<p>Raspberry Pi Forums: <a href="https://www.raspberrypi.org/forums/viewtopic.php?p=1501426">STICKY: If you have a Raspberry Pi 4 and are getting bad speeds transferring data to/from USB3.0 SSDs, read this</a>&#160;<a class="footnote-backref" href="#fnref:9" title="Jump back to footnote 9 in the text">&#8617;</a></p>
</li>
</ol>
</div>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://undecv.github.io/tag/zh_tw.html">zh_TW</a>
      <a href="https://undecv.github.io/tag/raspberry-pi.html">Raspberry Pi</a>
      <a href="https://undecv.github.io/tag/nas.html">NAS</a>
      <a href="https://undecv.github.io/tag/hdd.html">HDD</a>
      <a href="https://undecv.github.io/tag/ethernet.html">Ethernet</a>
      <a href="https://undecv.github.io/tag/wi-fi.html">Wi-Fi</a>
    </p>
  </div>





</article>

    <footer>
<p>&copy; 2021 キャンディージャー</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="https://undecv.github.io/theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="dark"
          type="text/javascript">
  </script>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " キャンディージャー ",
  "url" : "https://undecv.github.io",
  "image": "/images/128.png",
  "description": "undecV's Blog"
}
</script>


</body>
</html>